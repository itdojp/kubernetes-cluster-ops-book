# スクリーンショット方針（本書）

本書は Markdown の code block を一次情報とし、スクリーンショットは「実行すると何が表示されるか」「どこを確認すべきか」を補助する目的で追加する。

運用・障害対応ではダッシュボード/管理画面（例: Kubernetes Dashboard、Grafana 等）を扱う場合があるため、機微情報の取り扱いを最優先する。

## 対象環境（推奨）

- OS: Ubuntu 24.04 LTS
- 端末: 1カラム + Light（例: GNOME Terminal）
- フォント: JetBrains Mono 14pt（相当の等幅フォントで可）
- 画面幅: 横スクロールが発生しない幅（目安: 1200px 以上）

※ 取得環境が異なる場合でも、コマンド出力とキャプションで差分が出ないように調整する。

## マスキング（必須）

スクリーンショットに写り得る以下の情報は必ず無害化する。

- 組織名、プロジェクト名、チーム名などの識別子
- クラスタ名、コンテキスト名
- ユーザー名、ホームパス
- メールアドレス、アカウントID、社員番号などの個人識別子
- 社内ドメイン、内部ホスト名（FQDN を含む）、IP
- トークン、APIキー、Cookie、セッションID
- レジストリURL、クラウドアカウントID
- Namespace 名、テナントID 等（必要に応じて）

補足:
- kubeconfig や認証情報が表示される画面/コマンドは原則スクリーンショット化しない。
- ダッシュボード系は、ログイン情報やクエリ履歴が写りやすいので特に注意する。

## 配置と命名

- 配置: `src/chapters/chapterXX/images/`（章ごとに配置し、相対パスで参照する）
  - `npm run build` で `src/` 配下の画像（非 Markdown ファイル）を `docs/` に同期するため、`dist/` にも含まれる
- 形式: PNG（必要に応じて WebP）
- 命名: `chXX-<topic>-NN.png`
  - `XX`: 章番号（2桁）
  - `topic`: 英小文字の kebab-case（例: `kubeadm-upgrade`）
  - `NN`: 2桁（章内の並び順）
  - 例: `ch03-kubeadm-upgrade-01.png`

## 本文への埋め込み

- 画像には alt text と短いキャプション（「何を示すか」「どこを見るか」）を付ける。
- 「作業 → 確認 → 結果」が 1 セットの最小単位になるように配置する。
- 余計なUI（ブラウザタブ、通知、プロンプト履歴など）は写さず、要点が読める範囲でトリミングする。

## 追加後の確認

1. 画像を配置し、本文から参照を追加
2. `npm run build`
3. `npm run serve` で表示崩れ/リンク切れがないことを確認

## スクリーンショット候補チェックリスト（章別）

本セクションは Issue #7 の内容を「何を撮るか」「前提状態」の観点で章別に整理したチェックリストです（画像追加は別PRで実施）。

方針:
- ツール固有の UI（例: Grafana/Prometheus/Alertmanager/Loki 等）はあくまで「例」とし、本文はツール非依存の型を維持する。
- スクリーンショットは「観測 → 判断 → 復旧（または変更）」の最小セットを意識する。

### 第0章：前提とスコープ

前提（例）:
- 責任分界や申請フローが分かる運用物（チケット/申請フォーム/手順書）が存在する

- [ ] 共有責任モデル（責任分界表）の「読み方」を補助する画面（例: チケット/申請フォームのサンプル）

### 第1章：クラスタ設計の全体像

前提（例）:
- クラスタの棚卸し（Inventory）情報を取得できる（IaC/アドオン管理/運用台帳等）

- [ ] クラスタ棚卸し（Inventory）のサンプル（アドオン一覧、ノードプール、CRD/Webhook、外部依存: DNS/LB/レジストリ）

### 第2章：コントロールプレーン設計

前提（例）:
- クラスタに接続できる kubeconfig/context が選択済み
- API ヘルスエンドポイント閲覧権限がある（RBAC）
- （任意）監視基盤が導入済み

- [ ] 端末: API の健全性確認（`kubectl get --raw='/readyz?verbose'` 等）
- [ ] ダッシュボード（例: Grafana）: API Server の主要指標（エラーレート/レイテンシ/飽和の入口が分かる）

### 第3章：etcd設計とバックアップ

前提（例）:
- etcd のバックアップ取得（ジョブ/運用手順）と保管先（オブジェクトストレージ等）がある

- [ ] バックアップ成功/失敗が分かる画面（バックアップジョブのログ、スナップショット一覧）
- [ ] （自前の場合）etcd の状態確認（端末/ダッシュボード）

### 第4章：ノード/ランタイム運用

前提（例）:
- ノード一覧/状態を取得できる
- ノードログ（kubelet/container runtime）を参照できる
- （任意）アラート運用がある

- [ ] 端末: `kubectl get nodes -o wide` / `kubectl describe node ...` の主要部
- [ ] アラート画面（例: Alertmanager）: Node NotReady / Pressure の発報例
- [ ] 端末: ノードログの抜粋（例: `journalctl -u kubelet`）

### 第5章：ネットワーク設計と運用

前提（例）:
- CoreDNS/Ingress 等の基盤コンポーネントが稼働している
- （任意）ネットワーク系ダッシュボード/メトリクスがある

- [ ] 端末: CoreDNS の状態/ログ（`kubectl -n kube-system get pods -l k8s-app=kube-dns` 等）
- [ ] 端末: Service 到達性の確認（`kubectl exec` / `curl` / `nslookup` 等）
- [ ] ダッシュボード（例）: DNS 失敗率、レイテンシ、欠測が分かる画面

### 第6章：ストレージ設計と運用

前提（例）:
- StorageClass/PVC/PV が運用対象として存在する

- [ ] 端末: PVC/PV/StorageClass の状態（`kubectl get pvc,pv,sc` 等）
- [ ] 端末: Attach/Mount 失敗時の Events（`kubectl describe pvc/pod`）
- [ ] （任意）ダッシュボード: ストレージ I/O 指標が分かる画面

### 第7章：認証・認可と基本セキュリティ

前提（例）:
- RBAC を運用している（Role/RoleBinding 等）
- （任意）監査ログ（audit）が有効で検索できる

- [ ] 端末: `kubectl auth can-i ...` の実行例（運用確認の型）
- [ ] 端末: RoleBinding/ClusterRoleBinding の一覧・差分確認
- [ ] （可能なら）監査ログ検索（例: ログ基盤 UI）

### 第8章：マルチテナントとリソース管理

前提（例）:
- Namespace による分離を運用している
- ResourceQuota/LimitRange/PSS/NetworkPolicy 等を適用している（または適用検討中）

- [ ] 端末: Namespace 一覧とラベル
- [ ] 端末: ResourceQuota/LimitRange の設定と反映（適用前後の差分が分かる）
- [ ] 端末/UI: PodSecurity（PSS）や NetworkPolicy の適用状態

### 第9章：監視・ログ・アラート設計

前提（例）:
- 監視（Prometheus 等）/ダッシュボード（Grafana 等）/アラート（Alertmanager 等）/ログ（Loki 等）のいずれかを導入済み

- [ ] ダッシュボード（例）: API Server / etcd / Node / CoreDNS / Ingress / CSI の最小セット
- [ ] アラート画面（例: Alertmanager）: アラート一覧、ラベル（Sev/Runbook）、silence 運用
- [ ] ログ検索画面（例: Loki）: 変更点と事象を相関できる検索例

### 第10章：アップグレード戦略

前提（例）:
- 変更管理の運用（チケット/PR/Runbook）がある
- （任意）CI/CD の実行結果を参照できる

- [ ] 変更管理（チケット/PR）のサンプル（事前確認/検証/中断条件/証跡が埋まった状態）
- [ ] （可能なら）CI/CD 実行結果（例: GitHub Actions）

### 第11章：障害対応とトラブルシュート

前提（例）:
- アラート受信→Runbook の導線がある（ラベル/リンク等）
- 付録B（フロー集）の最小コマンドセットを実行できる

- [ ] インシデント初動（アラート受信→Runbook）: アラート画面＋Runbook へのリンクが見える
- [ ] 端末: 付録Bフローの「最小コマンドセット」の実行例

### 第12章：自動化と運用標準化

前提（例）:
- 運用チェックを自動化する仕組み（CI、ポリシー、定期検査等）がある

- [ ] 自動チェックの実行結果（例: GitHub Actions の `book-qa` 成功画面）
- [ ] 変更時チェックリストのテンプレ運用（例: PR テンプレ/チェックリスト）

### 付録（候補）

- [ ] 付録A（チェックリストPack）: 証跡（チェック済み状態）が分かる運用物のサンプル
- [ ] 付録B（フロー集）: 各フローの「最小コマンドセット」実行例（端末）
